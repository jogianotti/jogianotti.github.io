<!doctype html><html lang=es><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><title>Una Mínima Separación en Capas - Sitio personal</title><meta property="og:title" content="Una mínima separación en capas - Sitio personal"><meta property="og:type" content="website"><meta property="og:description" content="Con una mínima separación de capas se puede obtener grandes beneficios"><meta property="og:url" content="https://jogianotti.github.io/blog/una_minima_separacion_en_capas/"><meta property="og:site_name" content="Sitio personal"><meta property="og:image" content="https://jogianotti.github.io/blog/una_minima_separacion_en_capas/estado_final.png"><meta property="og:image" content="https://jogianotti.github.io/blog/una_minima_separacion_en_capas/estado_inicial.png"><link rel=stylesheet href=/css/main.min.90b222cb906d19c062d318117493659ac4fc5cc0f16493f0dc4a63c523e8dc98.css integrity="sha256-kLIiy5BtGcBi0xgRdJNlmsT8XMDxZJPw3EpjxSPo3Jg=" crossorigin=anonymous media=screen></head><body><section id=top class=section><div class="container hero fade-in one"><h1 class="bold-title is-1">Publicaciones</h1></div><div class="section fade-in two"><div class=container><hr><nav class=navbar role=navigation aria-label="main navigation"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><div class=navbar-menu id=navMenu><a class=navbar-item href=/>Principal</a>
<a class=navbar-item href=https://jogianotti.github.io/publicaciones/>Volver a Publicaciones</a></div></nav><hr></div><div class=container><h2 class="title is-1 top-pad strong-post-title"><a href=https://jogianotti.github.io/blog/una_minima_separacion_en_capas/>Una mínima separación en capas</a></h2><div class=post-data>May 02, 2021 |
3 minutos de lectura</div><p>Categorias:
<a href=/categories/arquitectura>arquitectura</a></p><p>Etiquetas:
<a href=/tags/dominio>dominio</a>,
<a href=/tags/infraestructura>infraestructura</a>,
<a href=/tags/tests>tests</a></p></div><div class="container markdown top-pad"><h4 id=acoplamiento class=anchor-link><a href=#acoplamiento>Acoplamiento</a></h4><p>En desarrollo web es muy frecuente terminar con una arquitectura donde el nivel de acoplamiento dificulta la mantenibilidad del código de un proyecto.</p><p>Yo fui culpable de este &ldquo;error&rdquo; que no siempre es un error, pero dado el caso de una aplicación con expectativas de crecimiento este &ldquo;error&rdquo; se deberían evitar.</p><p>Cuando hablo de acoplamiento me refiero a un método controlador que se encarga de todo lo relacionado con la atención de una solicitud. Este método se encarga de recibir la solicitud, procesar los datos de entrada, ejecutar la lógica relacionada con el caso de uso, realizar tareas secundarias que se desprenden de ese caso de uso, comunicarse con servicios externos enviando o recibiendo datos, preparar los datos resultantes y por último retornar una respuesta.</p><p>Aquí pongo un ejemplo gráfico.</p><figure><img src=estado_inicial.png></figure><p>Se puede ver como el controlador gestiona y coordina la colaboración con el resto de las clases del sistema necesarias para atender la solicitud que recibe, siendo el responsable de todas las tareas mencionadas anteriormente.</p><p>Lo más importante a prestar atención es el hecho de que es el controlador quien contiene la <strong>lógica del caso de uso</strong> lo que dificulta la reutilización del mismo y la incorporación de tests útiles.</p><p>Si se quisiera reutilizar ese caso de uso, por ejemplo en un comando por consola, se deberían imitar los mismos pasos que se siguen en el controlador dificultando la mantenibilidad y consistencia de ese caso de uso. Además si se quisiera crear un test para ese caso de uso se debería realizar sobre la salida del controlador que en muchos casos significa procesar código HTML por lo que el test se volvería más complejo y lento.</p><h4 id=separación-en-dos-capas class=anchor-link><a href=#separaci%c3%b3n-en-dos-capas>Separación en dos capas</a></h4><p>¿De qué forma se puede modificar esta arquitectura con el fin de mejorar la reutilización y permitir la incorporación de tests útiles?</p><p>Hay dos tareas relativamente sencillas que permiten tener una separación clara en dos capas. Una se suele nombrar como capa de <strong>dominio</strong> y la otra como capa de <strong>infraestructura</strong>. Nuestra capa de dominio contiene todo el código relacionado con nuestra <strong>lógica de negocio</strong>. Nuestra capa de infraestructura contiene todo el código que interviene en tareas de <strong>entrada/salida</strong>.</p><p>Lo primero es agrupar toda la lógica del caso de uso en su propia clase que será inyectada como colaborador del controlador o de cualquier otra clase que la requiera. Esto permite la reutilización de ese caso de uso manteniendo así la consistencia.</p><p>Lo segundo es implementar el <strong>principio de inversión de dependencia (DIP)</strong> para la relación con todos los servicios externos. Este principio establece que <em>&ldquo;módulos de alto nivel no deberían depender de los de bajo nivel, ambos deberían depender de abstracciones&rdquo;</em>. Entonces tomando este principio podemos decir que nuestro dominio no debería depender de un determinado servicio sino de una abstracción. Para lograr esto simplemente debemos establecer interfaces que definan el protocolo de comunicación con los diferentes servicios que utiliza nuestra aplicación y que nuestro dominio dependa solo de esas interfaces que serán nuestra abstracción.</p><p>Para hacer bien gráfico este ejemplo aquí está la arquitectura a la que se pretende llegar con este proceso.</p><figure><img src=estado_final.png></figure><h4 id=conclusión class=anchor-link><a href=#conclusi%c3%b3n>Conclusión</a></h4><p>Con una simple organización de nuestro desarrollo se tienen grandes beneficios que apuntan a tener una base de código que sea <strong>fácil de mantener</strong> y que <strong>tolere el cambio</strong>.</p></div><div class=container><hr></div><div class="container has-text-centered top-pad"><a href=#top><i class="fa fa-arrow-up"></i></a></div><div class=container><hr></div><div class=section id=footer><div class="container has-text-centered"><span class=footer-text>Tema <a href=https://github.com/victoriadrake/hugo-theme-introduction/><strong>Introduction</strong></a> para <a href=http://gohugo.io/>Hugo</a>. Hecho con <a href=https://victoria.dev>y</a> por colaboradores de código abierto.</span></div></div></div></section><script src=https://jogianotti.github.io/js/bundle.f1741e9868b2f697e71cf8fccfcc12166540999b3d36f8fb9edd0882ba425d55.js integrity="sha256-8XQemGiy9pfnHPj8z8wSFmVAmZs9Nvj7nt0IgrpCXVU="></script></body></html>